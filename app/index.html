<!DOCTYPE html>
<html ng-app="MindDrop">
  <head>
    <title>Hello World!</title>
    <link rel="stylesheet" type="text/css" href="css/style.css">
  </head>
  <body ng-controller="MainCtrl">
    <img style="width:100px;height:100px;" src="icon/icon.png" ng-click="fuck()">
    <section></section>
    <!-- <div class="mask"></div> -->

    <script type="text/javascript" src="js/angular.min.js"></script>
    <script type="text/javascript">
	  	var gui = require('nw.gui'); //or global.window.nwDispatcher.requireNwGui() (see https://github.com/rogerwang/node-webkit/issues/707)

		// Get the current window
		var win = gui.Window.get();
		
		win.showDevTools();

		var contextMenu = new gui.Menu();

		contextMenu.append(new gui.MenuItem({ label: 'Item A' }));
		contextMenu.append(new gui.MenuItem({ label: 'Item B' }));
		contextMenu.append(new gui.MenuItem({ type: 'separator' }));
		contextMenu.append(new gui.MenuItem({ label: 'Item C' }));

		// document.body.addEventListener('contextmenu', function(ev) { 

		// });

		angular.module('MindDrop',[])
		.run(function(){
			var mousedown=false;
			var mousecoor=[0,0];


			angular.element(document).find('body').bind('contextmenu',function(e){
				e.preventDefault();
		  		contextMenu.popup(e.x, e.y);
		 		return false;
			})

			angular.element(document).find('section').bind('mousedown',function(e){
				mousedown=true;
				mousecoor=[e.screenX, e.screenY];
			})
			angular.element(document).find('section').bind('mousemove',function(e){
				if (mousedown) {
					win.moveBy(e.screenX-mousecoor[0], e.screenY-mousecoor[1])
					mousecoor=[e.screenX,e.screenY];
				}
			})
			angular.element(document).find('section').bind('mouseup',function(e){
				mousedown=false;
				win.moveTo(e.screenX-e.pageX, e.screenY-e.pageY)
			})

			angular.element(document).find('section').bind('mouseleave',function(e){
				mousedown=false;
				// win.moveTo(e.screenX-e.pageX, e.screenY-e.pageY)
			})
		})
		.controller('MainCtrl',function($scope){
			$scope.fuck=function(){
				console.log('fxxk')
			}
		})
	</script>
  </body>

  
</html>
